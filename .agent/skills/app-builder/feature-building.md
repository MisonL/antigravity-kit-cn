# 功能构建 (Feature Building)

> 如何分析和实现新功能。

## 功能分析

```
请求: "添加支付系统"

分析:
├── 变更需求:
│   ├── 数据库: orders, payments 表
│   ├── 后端: /api/checkout, /api/webhooks/stripe
│   ├── 前端: CheckoutForm, PaymentSuccess
│   └── 配置: Stripe API keys
│
├── 依赖项:
│   ├── stripe package
│   └── 现有用户认证
│
└── 预估时间: 15-20 分钟
```

## 迭代增强流程

```
1. 分析现有项目
2. 创建变更计划 (PLAN.md)
3. 向用户展示计划
4. 获得批准
5. 应用变更
6. 测试
7. 显示预览
```

## 错误处理

| 错误类型        | 解决策略               |
| --------------- | ---------------------- |
| TypeScript 错误 | 修复类型，添加缺失导入 |
| 缺失依赖        | 运行 npm install       |
| 端口冲突        | 建议替代端口           |
| 数据库错误      | 检查迁移，验证连接     |

## 恢复策略

```
1. 检测错误
2. 尝试自动修复
3. 如果失败，向用户报告
4. 建议替代方案
5. 必须时回滚
```
