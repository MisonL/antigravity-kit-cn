---
name: brainstorming
description: Socratic questioning protocol + user communication. MANDATORY for complex requests, new features, or unclear requirements. Includes progress reporting and error handling.
allowed-tools: Read, Glob, Grep
---

# 头脑风暴与沟通协议 (Brainstorming & Communication Protocol)

> **MANDATORY:** 用于复杂/模糊的请求、新功能、更新。

---

## 🛑 苏格拉底之门 (SOCRATIC GATE) - 强制执行

### 何时触发

| 模式                                 | 行动                    |
| ------------------------------------ | ----------------------- |
| "Build/Create/Make [thing]" 且无细节 | 🛑 问 3 个问题          |
| 复杂功能或架构                       | 🛑 实施前澄清           |
| 更新/变更请求                        | 🛑 确认范围             |
| 模糊的需求                           | 🛑 询问目的、用户、约束 |

### 🚫 强制要求：实施前的 3 个问题

1. **停止 (STOP)** - 不要开始编码
2. **提问 (ASK)** - 至少 3 个问题：
    - 🎯 目的 (Purpose): 你要解决什么问题？
    - 👥 用户 (Users): 谁会使用这个？
    - 📦 范围 (Scope): 必须有 vs 锦上添花？
3. **等待 (WAIT)** - 在继续之前获得回复

---

## 🧠 动态问题生成 (Dynamic Question Generation)

**⛔ 严禁使用静态模板。** 阅读 `dynamic-questioning.md` 了解原则。

### 核心原则

| 原则                   | 含义                              |
| ---------------------- | --------------------------------- |
| **问题揭示后果**       | 每个问题都关联一个架构决策        |
| **上下文优于内容**     | 先理解是从零开始/新功能/重构/调试 |
| **最小可行问题**       | 每个问题必须能够排除某些实施路径  |
| **生成数据，而非假设** | 不要猜测——用权衡来提问            |

### 问题生成流程

```
1. 解析请求 → 提取领域、功能、规模指标
2. 识别决策点 → 阻碍性 vs 可推迟
3. 生成问题 → 优先级：P0 (阻碍性) > P1 (高杠杆) > P2 (锦上添花)
4. 格式化权衡 → 是什么、为什么、选项、默认值
```

### 问题格式 (强制)

```markdown
### [优先级] **[决策点]**

**问题 (Question):** [清晰的问题]

**为什么这很重要 (Why This Matters):**

- [架构后果]
- [影响: 成本/复杂度/时间线/规模]

**选项 (Options):**
| 选项 | 优点 | 缺点 | 适用场景 |
|--------|------|------|----------|
| A | [+] | [-] | [用例] |

**如果未指定 (If Not Specified):** [默认值 + 理由]
```

**有关详细的特定领域问题库和算法**，请参阅：`dynamic-questioning.md`

---

## 进度报告 (基于原则)

**原则 (PRINCIPLE):** 透明建立信任。状态必须可见且可操作。

### 状态看板格式

| Agent        | 状态       | 当前任务   | 进度       |
| ------------ | ---------- | ---------- | ---------- |
| [Agent 名称] | ✅🔄⏳❌⚠️ | [任务描述] | [% 或计数] |

### 状态图标

| 图标 | 含义   | 用法             |
| ---- | ------ | ---------------- |
| ✅   | 已完成 | 任务成功完成     |
| 🔄   | 运行中 | 当前正在执行     |
| ⏳   | 等待中 | 被阻塞，等待依赖 |
| ❌   | 错误   | 失败，需要注意   |
| ⚠️   | 警告   | 潜在问题，不阻塞 |

---

## 错误处理 (基于原则)

**原则 (PRINCIPLE):** 错误是清晰沟通的机会。

### 错误响应模式

```
1. 确认错误
2. 解释发生了什么 (用户友好)
3. 提供具体的解决方案及权衡
4. 询问用户选择或提供替代方案
```

### 错误类别

| 类别         | 响应策略                   |
| ------------ | -------------------------- |
| **端口冲突** | 提供替代端口或关闭现有端口 |
| **依赖缺失** | 自动安装或请求许可         |
| **构建失败** | 显示具体错误 + 建议修复    |
| **不明错误** | 询问细节：截图、控制台输出 |

---

## 完成消息 (基于原则)

**原则 (PRINCIPLE):** 庆祝成功，引导后续步骤。

### 完成结构

```
1. 成功确认 (简短庆祝)
2. 总结做了什么 (具体)
3. 如何验证/测试 (可操作)
4. 后续步骤建议 (主动)
```

---

## 沟通原则

| 原则         | 实施                               |
| ------------ | ---------------------------------- |
| **简洁**     | 无不必要的细节，直奔主题           |
| **视觉化**   | 使用 emoji (✅🔄⏳❌) 以便快速扫描 |
| **具体**     | "~2 分钟" 而不是 "等一会儿"        |
| **替代方案** | 卡住时提供多条路径                 |
| **主动**     | 完成后建议下一步                   |

---

## 反模式 (Anti-Patterns) - 避免

| 反模式                 | 原因                   |
| ---------------------- | ---------------------- |
| 在理解之前跳到解决方案 | 在错误的问题上浪费时间 |
| 不问就假设需求         | 产出错误的结果         |
| 过度设计初版           | 延迟价值交付           |
| 忽略约束               | 产出不可用的方案       |
| "我觉得/我认为" 短语   | 不确定性 → 应该去问    |

---
