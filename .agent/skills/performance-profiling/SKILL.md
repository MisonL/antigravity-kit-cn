---
name: performance-profiling
description: æ€§èƒ½åˆ†æåŸåˆ™ã€‚æµ‹é‡ã€åˆ†æä¸ä¼˜åŒ–æŠ€æœ¯ã€‚
allowed-tools: Read, Glob, Grep, Bash
---

# Performance Profiling - æ€§èƒ½åˆ†æ

> æµ‹è¯•ï¼Œåˆ†æï¼Œä¼˜åŒ– - æŒ‰æ­¤é¡ºåºã€‚

## ğŸ”§ è¿è¡Œæ—¶è„šæœ¬ (Runtime Scripts)

**æ‰§è¡Œè¿™äº›è¿›è¡Œè‡ªåŠ¨åŒ–åˆ†æï¼š**

| è„šæœ¬                          | ç”¨é€”                | ç”¨æ³•                                                     |
| ----------------------------- | ------------------- | -------------------------------------------------------- |
| `scripts/lighthouse_audit.py` | Lighthouse æ€§èƒ½å®¡è®¡ | `python scripts/lighthouse_audit.py https://example.com` |

---

## 1. æ ¸å¿ƒ Web æŒ‡æ ‡ (Core Web Vitals)

### ç›®æ ‡

| æŒ‡æ ‡    | å¥½      | å·®      | è¡¡é‡                   |
| ------- | ------- | ------- | ---------------------- |
| **LCP** | < 2.5s  | > 4.0s  | åŠ è½½ (Loading)         |
| **INP** | < 200ms | > 500ms | äº¤äº’æ€§ (Interactivity) |
| **CLS** | < 0.1   | > 0.25  | ç¨³å®šæ€§ (Stability)     |

### ä½•æ—¶æµ‹é‡

| é˜¶æ®µ               | å·¥å…·               |
| ------------------ | ------------------ |
| å¼€å‘ (Development) | æœ¬åœ° Lighthouse    |
| CI/CD              | Lighthouse CI      |
| ç”Ÿäº§ (Production)  | RUM (çœŸå®ç”¨æˆ·ç›‘æ§) |

---

## 2. åˆ†æå·¥ä½œæµ (Profiling Workflow)

### 4 æ­¥æµç¨‹

```
1. BASELINE (åŸºçº¿) â†’ æµ‹é‡å½“å‰çŠ¶æ€
2. IDENTIFY (è¯†åˆ«) â†’ æ‰¾åˆ°ç“¶é¢ˆ
3. FIX (ä¿®å¤) â†’ è¿›è¡Œæœ‰é’ˆå¯¹æ€§çš„æ›´æ”¹
4. VALIDATE (éªŒè¯) â†’ ç¡®è®¤æ”¹è¿›
```

### åˆ†æå·¥å…·é€‰æ‹©

| é—®é¢˜     | å·¥å…·                 |
| -------- | -------------------- |
| é¡µé¢åŠ è½½ | Lighthouse           |
| åŒ…ä½“ç§¯   | Bundle analyzer      |
| è¿è¡Œæ—¶   | DevTools Performance |
| å†…å­˜     | DevTools Memory      |
| ç½‘ç»œ     | DevTools Network     |

---

## 3. åŒ…åˆ†æ (Bundle Analysis)

### å¯»æ‰¾ä»€ä¹ˆ

| é—®é¢˜         | æŒ‡ç¤ºå™¨       |
| ------------ | ------------ |
| å¤§ä¾èµ–       | åŒ…çš„é¡¶éƒ¨     |
| é‡å¤ä»£ç      | å¤šä¸ª Chunk   |
| æœªä½¿ç”¨çš„ä»£ç  | ä½è¦†ç›–ç‡     |
| ç¼ºå¤±æ‹†åˆ†     | å•ä¸ªå¤§ Chunk |

### ä¼˜åŒ–è¡ŒåŠ¨

| å‘ç°         | è¡ŒåŠ¨           |
| ------------ | -------------- |
| å¤§åº“         | å¯¼å…¥ç‰¹å®šæ¨¡å—   |
| é‡å¤ä¾èµ–     | å»é‡ï¼Œæ›´æ–°ç‰ˆæœ¬ |
| è·¯ç”±åœ¨ä¸»åŒ…ä¸­ | ä»£ç æ‹†åˆ†       |
| æœªä½¿ç”¨çš„å¯¼å‡º | Tree shake     |

---

## 4. è¿è¡Œæ—¶åˆ†æ (Runtime Profiling)

### Performance æ ‡ç­¾åˆ†æ

| æ¨¡å¼           | å«ä¹‰             |
| -------------- | ---------------- |
| é•¿ä»»åŠ¡ (>50ms) | UI é˜»å¡          |
| è®¸å¤šå°ä»»åŠ¡     | å¯èƒ½çš„æ‰¹å¤„ç†æœºä¼š |
| å¸ƒå±€/ç»˜åˆ¶      | æ¸²æŸ“ç“¶é¢ˆ         |
| è„šæœ¬           | JavaScript æ‰§è¡Œ  |

### Memory æ ‡ç­¾åˆ†æ

| æ¨¡å¼       | å«ä¹‰     |
| ---------- | -------- |
| å †å¢é•¿     | å¯èƒ½æ³„æ¼ |
| å¤§ä¿ç•™     | æ£€æŸ¥å¼•ç”¨ |
| åˆ†ç¦»çš„ DOM | æœªæ¸…ç†   |

---

## 5. å¸¸è§ç“¶é¢ˆ (Common Bottlenecks)

### æŒ‰ç—‡çŠ¶

| ç—‡çŠ¶       | å¯èƒ½åŸå›                     |
| ---------- | --------------------------- |
| åˆå§‹åŠ è½½æ…¢ | å¤§ JSï¼Œæ¸²æŸ“é˜»å¡             |
| äº¤äº’æ…¢     | ç¹é‡çš„äº‹ä»¶å¤„ç†ç¨‹åº          |
| æ»šåŠ¨å¡é¡¿   | å¸ƒå±€æŠ–åŠ¨ (Layout thrashing) |
| å†…å­˜å¢é•¿   | æ³„æ¼ï¼Œä¿ç•™çš„å¼•ç”¨            |

---

## 6. é€Ÿèµ¢ä¼˜å…ˆçº§ (Quick Win Priorities)

| ä¼˜å…ˆçº§ | è¡ŒåŠ¨         | å½±å“ |
| ------ | ------------ | ---- |
| 1      | å¯ç”¨å‹ç¼©     | é«˜   |
| 2      | æ‡’åŠ è½½å›¾åƒ   | é«˜   |
| 3      | ä»£ç æ‹†åˆ†è·¯ç”± | é«˜   |
| 4      | ç¼“å­˜é™æ€èµ„äº§ | ä¸­   |
| 5      | ä¼˜åŒ–å›¾åƒ     | ä¸­   |

---

## 7. åæ¨¡å¼ (Anti-Patterns)

| âŒ ä¸è¦ (Don't) | âœ… è¦ (Do)             |
| --------------- | ---------------------- |
| çŒœæµ‹é—®é¢˜        | å…ˆåˆ†æ (Profile first) |
| å¾®ä¼˜åŒ–          | ä¿®å¤æœ€å¤§é—®é¢˜           |
| ææ—©ä¼˜åŒ–        | éœ€è¦æ—¶ä¼˜åŒ–             |
| å¿½ç•¥çœŸå®ç”¨æˆ·    | ä½¿ç”¨ RUM æ•°æ®          |

---

> **è®°ä½ï¼š** æœ€å¿«çš„ä»£ç æ˜¯ä¸è¿è¡Œçš„ä»£ç ã€‚åœ¨ä¼˜åŒ–ä¹‹å‰å…ˆç§»é™¤ã€‚
