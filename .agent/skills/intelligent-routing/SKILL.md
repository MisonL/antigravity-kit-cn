---
name: intelligent-routing
description: è‡ªåŠ¨ Agent é€‰æ‹©ä¸æ™ºèƒ½ä»»åŠ¡è·¯ç”±ã€‚åˆ†æç”¨æˆ·è¯·æ±‚å¹¶è‡ªåŠ¨é€‰æ‹©æœ€åˆé€‚çš„ä¸“å®¶çº§ Agentï¼Œæ— éœ€ç”¨æˆ·æ˜¾å¼æŒ‡å®šã€‚
version: 1.0.0
---

# æ™ºèƒ½ Agent è·¯ç”± (Intelligent Agent Routing)

**ç›®çš„**ï¼šè‡ªåŠ¨åˆ†æç”¨æˆ·è¯·æ±‚ï¼Œå¹¶å°†å…¶è·¯ç”±è‡³æœ€åˆé€‚çš„ä¸“å®¶çº§ Agentï¼Œè€Œæ— éœ€ç”¨æˆ·æ˜¾å¼æåŠã€‚

## æ ¸å¿ƒåŸåˆ™ (Core Principle)

> **AI åº”å……å½“æ™ºèƒ½é¡¹ç›®ç»ç† (Project Manager)**ï¼Œåˆ†ææ¯ä¸€ä¸ªè¯·æ±‚ï¼Œå¹¶è‡ªåŠ¨ä¸ºå½“å‰ä»»åŠ¡é€‰æ‹©æœ€ä½³çš„ä¸“å®¶ã€‚

---

## å·¥ä½œæœºåˆ¶ (How It Works)

### 1. è¯·æ±‚åˆ†æ (Request Analysis)

åœ¨å¯¹**ä»»ä½•**ç”¨æˆ·è¯·æ±‚åšå‡ºå“åº”ä¹‹å‰ï¼Œå…ˆè¿›è¡Œè‡ªåŠ¨åˆ†æï¼š

```mermaid
graph TD
    A["ç”¨æˆ·è¯·æ±‚ï¼šæ·»åŠ ç™»å½•åŠŸèƒ½"] --> B[åˆ†æ ANALYZE]
    B --> C[å…³é”®è¯]
    B --> D[æ‰€å±é¢†åŸŸ]
    B --> E[å¤æ‚åº¦]
    C --> F[é€‰æ‹© AGENT]
    D --> F
    E --> F
    F --> G["security-auditor + backend-specialist"]
    G --> H[å¸¦ä¸Šä¸‹æ–‡è‡ªåŠ¨æ¿€æ´»]
```

### 2. Agent é€‰æ‹©çŸ©é˜µ (Agent Selection Matrix)

**ä½¿ç”¨æ­¤çŸ©é˜µè‡ªåŠ¨é€‰æ‹© Agentï¼š**

| ç”¨æˆ·æ„å›¾            | å…³é”®è¯                                | æ‰€é€‰ Agent                                  | æ˜¯å¦è‡ªåŠ¨æ¿€æ´»ï¼Ÿ |
| ------------------- | ------------------------------------- | ------------------------------------------- | -------------- |
| **èº«ä»½è®¤è¯ (Auth)** | "ç™»å½•", "è®¤è¯", "æ³¨å†Œ", "å¯†ç "        | `security-auditor` + `backend-specialist`   | âœ… æ˜¯          |
| **UI ç»„ä»¶**         | "æŒ‰é’®", "å¡ç‰‡", "å¸ƒå±€", "æ ·å¼"        | `frontend-specialist`                       | âœ… æ˜¯          |
| **ç§»åŠ¨ç«¯ UI**       | "å±å¹•", "å¯¼èˆª", "è§¦æ‘¸", "æ‰‹åŠ¿"        | `mobile-developer`                          | âœ… æ˜¯          |
| **API ç«¯ç‚¹**        | "ç«¯ç‚¹", "è·¯ç”±", "API", "POST", "GET"  | `backend-specialist`                        | âœ… æ˜¯          |
| **æ•°æ®åº“**          | "æ¨¡å¼", "è¿ç§»", "æŸ¥è¯¢", "è¡¨"          | `database-architect` + `backend-specialist` | âœ… æ˜¯          |
| **Bug ä¿®å¤**        | "é”™è¯¯", "Bug", "ä¸å·¥ä½œ", "åäº†"       | `debugger`                                  | âœ… æ˜¯          |
| **æµ‹è¯•**            | "æµ‹è¯•", "è¦†ç›–ç‡", "å•å…ƒ", "E2E"       | `test-engineer`                             | âœ… æ˜¯          |
| **éƒ¨ç½²**            | "éƒ¨ç½²", "ç”Ÿäº§ç¯å¢ƒ", "CI/CD", "Docker" | `devops-engineer`                           | âœ… æ˜¯          |
| **å®‰å…¨å®¡æŸ¥**        | "å®‰å…¨", "æ¼æ´", "æ”»å‡»"                | `security-auditor` + `penetration-tester`   | âœ… æ˜¯          |
| **æ€§èƒ½**            | "æ…¢", "ä¼˜åŒ–", "æ€§èƒ½", "é€Ÿåº¦"          | `performance-optimizer`                     | âœ… æ˜¯          |
| **äº§å“å®šä¹‰**        | "éœ€æ±‚", "ç”¨æˆ·æ•…äº‹", "ç§¯å‹å·¥ä½œ", "MVP" | `product-owner`                             | âœ… æ˜¯          |
| **æ–°åŠŸèƒ½**          | "æ„å»º", "åˆ›å»º", "å®ç°", "æ–°åº”ç”¨"      | `orchestrator` â†’ å¤šæ™ºèƒ½ä½“åä½œ               | âš ï¸ å…ˆè¯¢é—®      |
| **å¤æ‚ä»»åŠ¡**        | æ£€æµ‹åˆ°æ¶‰åŠå¤šä¸ªé¢†åŸŸ                    | `orchestrator` â†’ å¤šæ™ºèƒ½ä½“åä½œ               | âš ï¸ å…ˆè¯¢é—®      |

---

### 3. è‡ªåŠ¨è·¯ç”±åè®® (Automatic Routing Protocol)

## TIER 0 - è‡ªåŠ¨åˆ†æ (å§‹ç»ˆæ¿€æ´»)

åœ¨å“åº”ä»»ä½•è¯·æ±‚ä¹‹å‰ï¼š

```javascript
// å†³ç­–æ ‘ä¼ªä»£ç ç¤ºä¾‹
function analyzeRequest(userMessage) {
    // 1. è¯·æ±‚ç±»å‹åˆ†ç±»
    const requestType = classifyRequest(userMessage);

    // 2. é¢†åŸŸæ£€æµ‹
    const domains = detectDomains(userMessage);

    // 3. ç¡®å®šå¤æ‚åº¦
    const complexity = assessComplexity(domains);

    // 4. é€‰æ‹© Agent
    if (complexity === "SIMPLE" && domains.length === 1) {
        return selectSingleAgent(domains[0]);
    } else if (complexity === "MODERATE" && domains.length <= 2) {
        return selectMultipleAgents(domains);
    } else {
        return "orchestrator"; // å¤æ‚ä»»åŠ¡
    }
}
```

---

## 4. å“åº”æ ¼å¼ (Response Format)

**åœ¨è‡ªåŠ¨é€‰æ‹© Agent æ—¶ï¼Œè¯·ç®€æ´åœ°å‘ŠçŸ¥è€æ¿ï¼š**

```markdown
ğŸ¤– **æ­£åœ¨åº”ç”¨ `@security-auditor` + `@backend-specialist` çš„çŸ¥è¯†â€¦â€¦**

[ç»§ç»­è¿›è¡Œä¸“ä¸šçš„å“åº”]
```

**ä¼˜åŠ¿ï¼š**

- âœ… è€æ¿å¯ä»¥çœ‹åˆ°åº”ç”¨äº†å“ªäº›ä¸“ä¸šçŸ¥è¯†ã€‚
- âœ… å†³ç­–è¿‡ç¨‹é€æ˜åŒ–ã€‚
- âœ… ä¾ç„¶æ˜¯è‡ªåŠ¨åŒ–çš„ï¼ˆæ— éœ€æ‰‹åŠ¨è¾“å…¥ /å‘½ä»¤ï¼‰ã€‚

---

## é¢†åŸŸæ£€æµ‹è§„åˆ™ (Domain Detection Rules)

### å•é¢†åŸŸä»»åŠ¡ (è‡ªåŠ¨æ¿€æ´»å•ä¸ª Agent)

| é¢†åŸŸ              | æ¨¡å¼/å…³é”®è¯                                | Agent                   |
| ----------------- | ------------------------------------------ | ----------------------- |
| **å®‰å…¨**          | auth, login, jwt, password, hash, token    | `security-auditor`      |
| **å‰ç«¯**          | component, react, vue, css, html, tailwind | `frontend-specialist`   |
| **åç«¯**          | api, server, express, fastapi, node        | `backend-specialist`    |
| **ç§»åŠ¨ç«¯**        | react native, flutter, ios, android, expo  | `mobile-developer`      |
| **æ•°æ®åº“**        | prisma, sql, mongodb, schema, migration    | `database-architect`    |
| **æµ‹è¯•**          | test, jest, vitest, playwright, cypress    | `test-engineer`         |
| **è¿ç»´ (DevOps)** | docker, kubernetes, ci/cd, pm2, nginx      | `devops-engineer`       |
| **è°ƒè¯•**          | error, bug, crash, not working, issue      | `debugger`              |
| **æ€§èƒ½**          | slow, lag, optimize, cache, performance    | `performance-optimizer` |
| **SEO**           | seo, meta, analytics, sitemap, robots      | `seo-specialist`        |
| **æ¸¸æˆ**          | unity, godot, phaser, game, multiplayer    | `game-developer`        |

### å¤šé¢†åŸŸä»»åŠ¡ (è‡ªåŠ¨æ¿€æ´»ç¼–æ’ä»£ç† Orchestrator)

å¦‚æœè¯·æ±‚åŒ¹é…äº† **2 ä¸ªæˆ–æ›´å¤šä¸åŒç±»åˆ«**çš„é¢†åŸŸï¼Œåˆ™è‡ªåŠ¨ä½¿ç”¨ `orchestrator`ï¼š

```text
ç¤ºä¾‹ï¼šâ€œåˆ›å»ºä¸€ä¸ªå¸¦æœ‰æš—è‰²æ¨¡å¼ UI çš„å®‰å…¨ç™»å½•ç³»ç»Ÿâ€
â†’ æ£€æµ‹åˆ°ï¼šå®‰å…¨ (Security) + å‰ç«¯ (Frontend)
â†’ è‡ªåŠ¨æ¿€æ´»ï¼šorchestrator
â†’ Orchestrator å°†åè°ƒï¼šsecurity-auditor, frontend-specialist, test-engineer
```

---

## å¤æ‚åº¦è¯„ä¼° (Complexity Assessment)

### ç®€å• (SIMPLE) (ç›´æ¥æ¿€æ´» Agent)

- å•ä¸ªæ–‡ä»¶ç¼–è¾‘ã€‚
- ä»»åŠ¡ç›®æ ‡æ¸…æ™°ä¸”å…·ä½“ã€‚
- ä»…æ¶‰åŠå•ä¸ªé¢†åŸŸã€‚
- ç¤ºä¾‹ï¼šâ€œä¿®å¤ç™»å½•æŒ‰é’®çš„æ ·å¼â€ã€‚

**è¡ŒåŠ¨**ï¼šè‡ªåŠ¨æ¿€æ´»å¯¹åº”çš„ Agentã€‚

### ä¸­ç­‰ (MODERATE) (2-3 ä¸ª Agent)

- æ¶‰åŠ 2-3 ä¸ªæ–‡ä»¶ã€‚
- éœ€æ±‚æ˜ç¡®ã€‚
- æœ€å¤šæ¶‰åŠ 2 ä¸ªé¢†åŸŸã€‚
- ç¤ºä¾‹ï¼šâ€œä¸ºç”¨æˆ·ä¸ªäººèµ„æ–™æ·»åŠ  API ç«¯ç‚¹â€ã€‚

**è¡ŒåŠ¨**ï¼šæŒ‰é¡ºåºè‡ªåŠ¨æ¿€æ´»ç›¸å…³ Agentã€‚

### å¤æ‚ (COMPLEX) (éœ€è¦ Orchestrator)

- æ¶‰åŠå¤šä¸ªæ–‡ä»¶/é¢†åŸŸã€‚
- éœ€è¦è¿›è¡Œæ¶æ„å±‚é¢çš„å†³ç­–ã€‚
- éœ€æ±‚å°šä¸æ˜ç¡®ã€‚
- ç¤ºä¾‹ï¼šâ€œæ„å»ºä¸€ä¸ªç¤¾äº¤åª’ä½“åº”ç”¨â€ã€‚

**è¡ŒåŠ¨**ï¼šè‡ªåŠ¨æ¿€æ´» `orchestrator` â†’ å°†ä¼šå¼€å¯è‹æ ¼æ‹‰åº•å¼æé—®ã€‚

---

## å®æ–½è§„åˆ™ (Implementation Rules)

### è§„åˆ™ 1ï¼šé™é»˜åˆ†æ (Silent Analysis)

#### **ä¸¥ç¦**å£°æ˜â€œæˆ‘æ­£åœ¨åˆ†ææ‚¨çš„è¯·æ±‚â€¦â€¦â€

- âœ… é»˜é»˜è¿›è¡Œåˆ†æã€‚
- âœ… å‘ŠçŸ¥æ­£åœ¨åº”ç”¨å“ªä¸ª Agentã€‚
- âŒ é¿å…å†—é•¿çš„å…ƒè¯„è®º (Meta-commentary)ã€‚

### è§„åˆ™ 2ï¼šå‘ŠçŸ¥ Agent é€‰æ‹©

**åŠ¡å¿…å‘ŠçŸ¥å½“å‰æ­£åœ¨åº”ç”¨å“ªäº›é¢†åŸŸçš„ä¸“ä¸šçŸ¥è¯†ï¼š**

```markdown
ğŸ¤– **æ­£åœ¨åº”ç”¨ `@frontend-specialist` çš„çŸ¥è¯†â€¦â€¦**

æˆ‘å°†æŒ‰ç…§ä»¥ä¸‹ç‰¹æ€§åˆ›å»ºè¯¥ç»„ä»¶ï¼š
[ç»§ç»­è¿›è¡Œä¸“ä¸šçš„å“åº”]
```

### è§„åˆ™ 3ï¼šæ— ç¼ä½“éªŒ

**è€æ¿ä¸åº”å¯Ÿè§‰åˆ°ä¸ç›´æ¥åŒæ­£ç¡®çš„ä¸“å®¶æ²Ÿé€šæœ‰ä»»ä½•åŒºåˆ«ã€‚**

### è§„åˆ™ 4ï¼šè¦†ç›–èƒ½åŠ› (Override)

**è€æ¿ä¾ç„¶å¯ä»¥æ˜¾å¼æŒ‡å®š Agentï¼š**

```text
è€æ¿ï¼šâ€œè¯·ä½¿ç”¨ @backend-specialist æ¥å®¡é˜…è¿™æ®µä»£ç â€
â†’ è¦†ç›–è‡ªåŠ¨é€‰æ‹©é€»è¾‘ã€‚
â†’ ä½¿ç”¨æ˜¾å¼æåˆ°çš„ Agentã€‚
```

---

## è¾¹ç¼˜æƒ…å†µ (Edge Cases)

### æƒ…å†µ 1ï¼šé€šç”¨å‹é—®é¢˜

```text
è€æ¿ï¼šâ€œReact æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿâ€
â†’ ç±»å‹ï¼šæé—® (QUESTION)
â†’ æ— éœ€ç‰¹å®š Agentã€‚
â†’ ç›´æ¥è¿›è¡Œè§£é‡Šè¯´æ˜ã€‚
```

### æƒ…å†µ 2ï¼šæå…¶æ¨¡ç³Šçš„è¯·æ±‚

```text
è€æ¿ï¼šâ€œæŠŠå®ƒåšå¾—æ›´å¥½â€
â†’ å¤æ‚åº¦ï¼šä¸æ˜ç¡® (UNCLEAR)
â†’ è¡ŒåŠ¨ï¼šé¦–å…ˆè¿›è¡Œæ¾„æ¸…æé—®ã€‚
â†’ ç„¶åå†è·¯ç”±è‡³åˆé€‚çš„ Agentã€‚
```

### æƒ…å†µ 3ï¼šå†²çªæ¨¡å¼

```text
è€æ¿ï¼šâ€œä¸º Web åº”ç”¨æ·»åŠ ç§»åŠ¨ç«¯æ”¯æŒâ€
â†’ å†²çªç‚¹ï¼šç§»åŠ¨ç«¯ vs Web
â†’ è¡ŒåŠ¨ï¼šè¯¢é—®ï¼šâ€œæ‚¨æ˜¯æƒ³è¦å“åº”å¼ Web è¿˜æ˜¯åŸç”Ÿçš„ç§»åŠ¨ Appï¼Ÿâ€
â†’ ç„¶åæ ¹æ®å›å¤è¿›è¡Œè·¯ç”±ã€‚
```

---

## ä¸ç°æœ‰å·¥ä½œæµé›†æˆ (Integration)

### ä¸ /orchestrate å‘½ä»¤é›†æˆ

- **è€æ¿è¾“å…¥ `/orchestrate`**ï¼šæ˜¾å¼è¿›å…¥ç¼–æ’æ¨¡å¼ã€‚
- **AI æ£€æµ‹åˆ°å¤æ‚ä»»åŠ¡**ï¼šè‡ªåŠ¨æ¿€æ´» Orchestratorï¼ˆç»“æœç›¸åŒï¼‰ã€‚

**åŒºåˆ«**ï¼šè€æ¿æ— éœ€çŸ¥é“è¯¥å‘½ä»¤çš„å­˜åœ¨ã€‚

### ä¸è‹æ ¼æ‹‰åº•ä¹‹é—¨ (Socratic Gate) é›†æˆ

- **è‡ªåŠ¨è·¯ç”±ä¸åº”ç»•è¿‡è‹æ ¼æ‹‰åº•ä¹‹é—¨ã€‚**
- å¦‚æœä»»åŠ¡ä¸æ˜ç¡®ï¼Œä¾ç„¶è¦å…ˆæé—®ã€‚
- æé—®åå†è·¯ç”±è‡³åˆé€‚çš„ Agentã€‚

### ä¸ GEMINI.md è§„åˆ™é›†æˆ

- **ä¼˜å…ˆçº§**ï¼šGEMINI.md è§„åˆ™ > æ™ºèƒ½è·¯ç”±ã€‚
- å¦‚æœ GEMINI.md æŒ‡å®šäº†æ˜¾å¼è·¯ç”±ï¼Œè¯·éµå¾ªè¯¥è§„åˆ™ã€‚
- æ™ºèƒ½è·¯ç”±æ˜¯åœ¨æ²¡æœ‰æ˜¾å¼è§„åˆ™æ—¶çš„**é»˜è®¤**æ–¹æ¡ˆã€‚

---

## ç³»ç»Ÿæµ‹è¯• (Testing)

### æµ‹è¯•æ¡ˆä¾‹

#### æµ‹è¯• 1ï¼šç®€å•å‰ç«¯ä»»åŠ¡

- ç”¨æˆ·è¯·æ±‚ï¼šâ€œåˆ›å»ºä¸€ä¸ªæš—è‰²æ¨¡å¼åˆ‡æ¢æŒ‰é’®â€
- é¢„æœŸç»“æœï¼šè‡ªåŠ¨æ¿€æ´» `frontend-specialist`
- éªŒè¯ï¼šå“åº”ä¸­æ˜¾ç¤ºâ€œæ­£åœ¨åº”ç”¨ @frontend-specialistâ€¦â€¦â€

#### æµ‹è¯• 2ï¼šå®‰å…¨ä»»åŠ¡

- ç”¨æˆ·è¯·æ±‚ï¼šâ€œå®¡æŸ¥èº«ä»½è®¤è¯æµç¨‹ä¸­çš„æ¼æ´â€
- é¢„æœŸç»“æœï¼šè‡ªåŠ¨æ¿€æ´» `security-auditor`
- éªŒè¯ï¼šæä¾›ä»¥å®‰å…¨ä¸ºæ ¸å¿ƒçš„åˆ†æã€‚

#### æµ‹è¯• 3ï¼šå¤æ‚å¤šé¢†åŸŸä»»åŠ¡

- ç”¨æˆ·è¯·æ±‚ï¼šâ€œæ„å»ºä¸€ä¸ªå¸¦æœ‰å®æ—¶é€šçŸ¥çš„èŠå¤©åº”ç”¨â€
- é¢„æœŸç»“æœï¼šè‡ªåŠ¨æ¿€æ´» `orchestrator`
- éªŒè¯ï¼šåè°ƒå¤šä¸ª Agentï¼ˆåç«¯ã€å‰ç«¯ã€æµ‹è¯•ï¼‰ã€‚

#### æµ‹è¯• 4ï¼šBug ä¿®å¤

- ç”¨æˆ·è¯·æ±‚ï¼šâ€œç™»å½•åŠŸèƒ½ä¸å·¥ä½œï¼ŒæŠ¥é”™ 401â€
- é¢„æœŸç»“æœï¼šè‡ªåŠ¨æ¿€æ´» `debugger`
- éªŒè¯ï¼šé‡‡ç”¨ç³»ç»ŸåŒ–çš„è°ƒè¯•æ–¹æ³•ã€‚

---

## æ€»ç»“ (Summary)

**æ™ºèƒ½è·¯ç”±æŠ€èƒ½å®ç°äº†ï¼š**

âœ… **é›¶å‘½ä»¤æ“ä½œ**ï¼ˆæ— éœ€ `/orchestrate`ï¼‰ã€‚
âœ… **åŸºäºè¯·æ±‚åˆ†æçš„ä¸“å®¶è‡ªåŠ¨é€‰æ‹©**ã€‚
âœ… **é€æ˜å‘ŠçŸ¥æ­£åœ¨åº”ç”¨å“ªäº›ä¸“ä¸šçŸ¥è¯†**ã€‚
âœ… **ä¸ç°æœ‰å·¥ä½œæµæ— ç¼é›†æˆ**ã€‚
âœ… **å…è®¸è€æ¿æ˜¾å¼æŒ‡å®š Agent è¿›è¡Œè¦†ç›–**ã€‚
âœ… **é’ˆå¯¹å¤æ‚ä»»åŠ¡è‡ªåŠ¨å›é€€è‡³ Orchestrator**ã€‚

**ç»“æœ**ï¼šè€æ¿æ— éœ€äº†è§£ç³»ç»Ÿæ¶æ„ï¼Œå³å¯è·å¾—ä¸“å®¶çº§çš„å“åº”ç»“æœã€‚

---

## Skills å…¼å®¹è¯´æ˜ (æœ€å°è¡¥å……)

- **æœºåˆ¶åŸºçº¿**ï¼šæ²¿ç”¨ä¸Šæ¸¸ `.agent/skills/intelligent-routing/SKILL.md`ã€‚
- **Codex é€‚é…**ï¼šç”±é€‚é…å±‚æ˜ å°„åˆ° `.agents/skills/intelligent-routing/SKILL.md`ã€‚
- **æ³¨æ„**ï¼šæ–‡æ¡£å±‚ä¸æ”¹æŠ€èƒ½æµç¨‹ï¼›ä»…è¡¥å……ç›®å½•æ˜ å°„äº‹å®ã€‚
