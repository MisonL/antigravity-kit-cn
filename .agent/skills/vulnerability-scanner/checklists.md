# 安全检查清单 (Security Checklists)

> 安全审计的快速参考清单。配合 vulnerability-scanner 原则使用。

---

## OWASP Top 10 审计清单

### A01: 访问控制失效 (Broken Access Control)

- [ ] 所有受保护路由的授权 (Authorization)
- [ ] 默认拒绝 (Deny by default)
- [ ] 已实现速率限制 (Rate limiting)
- [ ] CORS 配置正确

### A02: 加密失败 (Cryptographic Failures)

- [ ] 密码已哈希处理 (bcrypt/argon2, cost 12+)
- [ ] 静态敏感数据已加密
- [ ] 所有连接使用 TLS 1.2+
- [ ] 代码/日志中无机密信息 (Secrets)

### A03: 注入 (Injection)

- [ ] 参数化查询
- [ ] 所有用户数据进行输入验证
- [ ] XSS 输出编码
- [ ] 无 eval() 或动态代码执行

### A04: 不安全设计 (Insecure Design)

- [ ] 已完成威胁建模
- [ ] 已定义安全需求
- [ ] 业务逻辑已验证

### A05: 安全配置错误 (Security Misconfiguration)

- [ ] 已禁用不必要的功能
- [ ] 错误信息已净化 (Sanitized)
- [ ] 安全响应头 (Security headers) 已配置
- [ ] 默认凭据已更改

### A06: 易受攻击的组件 (Vulnerable Components)

- [ ] 依赖项已更新
- [ ] 无已知漏洞
- [ ] 移除未使用的依赖项

### A07: 认证失败 (Authentication Failures)

- [ ] MFA 可用
- [ ] 注销时会话失效
- [ ] 已实现会话超时
- [ ] 暴力破解保护

### A08: 完整性失败 (Integrity Failures)

- [ ] 依赖项完整性已验证
- [ ] CI/CD 管道已加固
- [ ] 更新机制已加固

### A09: 日志记录失败 (Logging Failures)

- [ ] 安全事件已记录
- [ ] 日志受保护
- [ ] 日志中无敏感数据
- [ ] 告警已配置

### A10: 服务端请求伪造 (SSRF)

- [ ] 已实现 URL 验证
- [ ] 外部调用的允许列表 (Allow-list)
- [ ] 网络分段

---

## 认证检查清单

- [ ] 强密码策略
- [ ] 账户锁定
- [ ] 安全密码重置
- [ ] 会话管理
- [ ] Token 过期
- [ ] 注销失效

---

## API 安全检查清单

- [ ] 需要认证
- [ ] 每个端点的授权
- [ ] 输入验证
- [ ] 速率限制
- [ ] 输出净化
- [ ] 错误处理

---

## 数据保护检查清单

- [ ] 静态加密
- [ ] 传输中加密
- [ ] 密钥管理
- [ ] 数据最小化
- [ ] 安全删除

---

## 安全响应头 (Security Headers)

| 响应头                        | 目的                    |
| ----------------------------- | ----------------------- |
| **Content-Security-Policy**   | XSS 预防                |
| **X-Content-Type-Options**    | MIME 嗅探               |
| **X-Frame-Options**           | 点击劫持 (Clickjacking) |
| **Strict-Transport-Security** | 强制 HTTPS              |
| **Referrer-Policy**           | Referrer 控制           |

---

## 快速审计命令

| 检查             | 寻找什么                    |
| ---------------- | --------------------------- |
| 代码中的机密信息 | password, api_key, secret   |
| 危险模式         | eval, innerHTML, SQL concat |
| 依赖项问题       | npm audit, snyk             |

---

> **用法:** 将相关清单复制到你的 PLAN.md 或安全报告中。
