---
name: vulnerability-scanner
description: 深度漏洞分析规程。涵盖 OWASP 2025、供应链安全、攻击面映射及风险优先级排序。
allowed-tools: Read, Glob, Grep, Bash
---

# 漏洞扫描专家 (Vulnerability Scanner)

> 像攻击者一样思考，像专家一样防御。紧跟 2025 威胁图谱。

## 🔧 运行时脚本 (Runtime Scripts)

| 脚本                       | 用途                     | 示例                                             |
| -------------------------- | ------------------------ | ------------------------------------------------ |
| `scripts/security_scan.py` | 验证项目中应用的安全原则 | `python scripts/security_scan.py <project_path>` |

---

## 1. 安全专家心态 (Security Expert Mindset)

### 核心原则

- **假定已遭入侵 (Assume Breach)**: 假设攻击者已经在系统内部进行设计。
- **零信任 (Zero Trust)**: 永不信任，始终验证。
- **纵深防御 (Defense in Depth)**: 多层防御，消除单点故障。
- **最小特权 (Least Privilege)**: 仅授予完成任务所需的最小权限。

---

## 2. OWASP Top 10:2025 风险类别

| 级别    | 类别              | 关注重点                             |
| ------- | ----------------- | ------------------------------------ |
| **A01** | 访问控制中断      | 谁能访问什么？IDOR, SSRF。           |
| **A02** | 安全配置错误      | 默认值、响应头、暴露的服务。         |
| **A03** | 软件供应链安全 🆕 | 依赖项审计、CI/CD 完整性、组件签名。 |
| **A04** | 加密失败          | 弱加密算法、泄露的密钥。             |
| **A10** | 异常情况处理 🆕   | 错误处理不当导致的 Fail-open 状态。  |

---

## 3. 供应链安全 (A03 - Supply Chain Security)

- **依赖项审计**: 是否存在恶意包？
- **锁定文件 (Lock files)**: 是否已提交并验证完整性？
- **CI/CD 管线**: 谁有权修改构建脚本？

---

## 4. 风险优先级矩阵 (Risk Prioritization)

```
风险 = 可能性 (Likelihood) × 影响 (Impact)
```

- **关键 (Critical)**: RCE、身份验证绕过、大规模数据泄露。
- **高 (High)**: 敏感数据暴露、权限提升。

---

## 5. 扫描方法论 (Scanning Methodology)

1. **侦察 (Reconnaissance)**: 了解技术栈与数据流。
2. **发现 (Discovery)**: 配置评审、依赖分析、代码模式搜索。
3. **分析 (Analysis)**: 排除误报，映射攻击链。
4. **报告 (Reporting)**: 提供可操作的修复建议。

---

## 6. 云安全考量 (Cloud Security)

- **IAM**: 是否应用了最小特权？
- **存储**: 是否存在公开的 S3 Bucket 或数据库？
- **密钥管理**: 是否使用了云端密钥管理服务 (Secrets Manager)？

---

> **记住：** 漏洞扫描只是发现问题。专家的思维在于识别哪些问题真正重要。始终问自己：“攻击者会利用这个漏洞做什么？”
