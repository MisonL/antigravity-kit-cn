---
name: 3d-games
description: 3d-games skill module
allowed-tools: Read, Write, Edit, Glob, Grep
---

# 3D 游戏开发 (3D Game Development)

> 3D 游戏系统原则。

---
name: 3d-games

## 1. 渲染管线 (Rendering Pipeline)

### 阶段

```
1. 顶点处理 (Vertex Processing) → 变换几何体
2. 光栅化 (Rasterization) → 转换为像素
3. 片元处理 (Fragment Processing) → 为像素着色
4. 输出 (Output) → 到屏幕
```

### 优化原则

| 技术                             | 目的             |
| -------------------------------- | ---------------- |
| **视锥体剔除 (Frustum culling)** | 不渲染屏幕外物体 |
| **遮挡剔除 (Occlusion culling)** | 不渲染被遮挡物体 |
| **LOD (多细节层次)**             | 远距离更少细节   |
| **合批 (Batching)**              | 合并绘制调用     |

---

## 2. 着色器原则 (Shader Principles)

### 着色器类型

| 类型                           | 目的       |
| ------------------------------ | ---------- |
| **Vertex (顶点)**              | 位置，法线 |
| **Fragment/Pixel (片元/像素)** | 颜色，光照 |
| **Compute (计算)**             | 通用计算   |

### 何时编写自定义着色器

- 特效 (水，火，传送门)
- 风格化渲染 (卡通，素描)
- 性能优化
- 独特的视觉标识

---

## 3. 3D 物理

### 碰撞形状

| 形状        | 适用场景     |
| ----------- | ------------ |
| **Box**     | 建筑物，箱子 |
| **Sphere**  | 球，快速检查 |
| **Capsule** | 角色         |
| **Mesh**    | 地形 (昂贵)  |

### 原则

- 简单的碰撞体，复杂的视觉效果
- 基于层的过滤
- 视线检测使用射线检测 (Raycasting)

---

## 4. 相机系统

### 相机类型

| 类型                   | 用途         |
| ---------------------- | ------------ |
| **第三人称**           | 动作，冒险   |
| **第一人称**           | 沉浸式，FPS  |
| **等轴测 (Isometric)** | 策略，RPG    |
| **轨道 (Orbital)**     | 检视，编辑器 |

### 相机手感

- 平滑跟随 (lerp)
- 避障
- 移动前瞻
- 随速度改变 FOV

---

## 5. 光照

### 光照类型

| 类型                     | 用途         |
| ------------------------ | ------------ |
| **Directional (定向光)** | 太阳，月亮   |
| **Point (点光源)**       | 灯，火把     |
| **Spot (聚光灯)**        | 手电筒，舞台 |
| **Ambient (环境光)**     | 基础照明     |

### 性能考量

- 实时阴影很昂贵
- 尽可能烘焙 (Bake)
- 大世界使用级联阴影 (Shadow cascades)

---

## 6. 多细节层次 (LOD)

### LOD 策略

| 距离 | 模型                     |
| ---- | ------------------------ |
| 近   | 全细节                   |
| 中   | 50% 三角形               |
| 远   | 25% 或公告板 (billboard) |

---

## 7. 反模式

| ❌ 错误              | ✅ 正确          |
| -------------------- | ---------------- |
| 哪里都用网格碰撞体   | 使用简单形状     |
| 移动端使用实时阴影   | 烘焙或 Blob 阴影 |
| 所有距离使用一个 LOD | 基于距离的 LOD   |
| 未优化的着色器       | 分析并简化       |

---

> **记住:** 3D 关乎错觉。创造细节的印象，而不是细节本身。
