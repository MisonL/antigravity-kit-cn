---
name: clean-code
description: åŠ¡å®çš„ç¼–ç è§„èŒƒ - ç®€æ´ã€ç›´æ¥ã€æ— è¿‡åº¦è®¾è®¡ã€æ— å†—ä½™æ³¨é‡Š
allowed-tools: Read, Write, Edit
version: 2.0
priority: CRITICAL
---

# Clean Code - åŠ¡å®çš„ AI ç¼–ç è§„èŒƒ

> **å…³é”®æŠ€èƒ½** - ä¿æŒ **ç®€æ´ã€ç›´æ¥ä¸”ä¸“æ³¨äºè§£å†³æ–¹æ¡ˆ**ã€‚

---

## æ ¸å¿ƒåŸåˆ™

| åŸåˆ™          | è§„åˆ™                                                         |
| ------------- | ------------------------------------------------------------ |
| **SRP**       | å•ä¸€èŒè´£åŸåˆ™ (Single Responsibility) - æ¯ä¸ªå‡½æ•°/ç±»åªåšä¸€ä»¶äº‹ |
| **DRY**       | ä¸è¦é‡å¤è‡ªå·± (Don't Repeat Yourself) - æå–é‡å¤é¡¹ï¼Œå¤ç”¨ä»£ç   |
| **KISS**      | ä¿æŒç®€å• (Keep It Simple) - ä½¿ç”¨èƒ½å·¥ä½œçš„æœ€ç®€å•æ–¹æ¡ˆ           |
| **YAGNI**     | ä½ ä¸éœ€è¦å®ƒ (You Aren't Gonna Need It) - ä¸è¦æ„å»ºæœªä½¿ç”¨çš„åŠŸèƒ½ |
| **Boy Scout** | ç«¥å­å†›å†›è§„ - è®©ä»£ç æ¯”ä½ å‘ç°æ—¶æ›´å¹²å‡€                          |

---

## å‘½åè§„åˆ™

| å…ƒç´           | çº¦å®š                                               |
| ------------- | -------------------------------------------------- |
| **Variables** | æ­ç¤ºæ„å›¾ï¼šç”¨ `userCount` è€Œä¸æ˜¯ `n`                |
| **Functions** | åŠ¨è¯ + åè¯ï¼šç”¨ `getUserById()` è€Œä¸æ˜¯ `user()`    |
| **Booleans**  | ç–‘é—®å¥å½¢å¼ï¼š`isActive`, `hasPermission`, `canEdit` |
| **Constants** | å¤§å†™è›‡å½¢å‘½åï¼š`MAX_RETRY_COUNT`                    |

> **è§„åˆ™:** å¦‚æœä½ éœ€è¦ç”¨æ³¨é‡Šæ¥è§£é‡Šä¸€ä¸ªåç§°ï¼Œè¯·é‡å‘½åå®ƒã€‚

---

## å‡½æ•°è§„åˆ™

| è§„åˆ™                | æè¿°                           |
| ------------------- | ------------------------------ |
| **Small**           | æœ€å¤š 20 è¡Œï¼Œç†æƒ³æƒ…å†µä¸‹ 5-10 è¡Œ |
| **One Thing**       | åªåšä¸€ä»¶äº‹ï¼Œå¹¶æŠŠå®ƒåšå¥½         |
| **One Level**       | æ¯ä¸ªå‡½æ•°ä»…åŒ…å«ä¸€å±‚æŠ½è±¡         |
| **Few Args**        | æœ€å¤š 3 ä¸ªå‚æ•°ï¼Œæœ€å¥½ 0-2 ä¸ª     |
| **No Side Effects** | ä¸è¦æ„å¤–åœ°æ”¹å˜è¾“å…¥             |

---

## ä»£ç ç»“æ„

| æ¨¡å¼              | åº”ç”¨                          |
| ----------------- | ----------------------------- |
| **Guard Clauses** | å«è¯­å¥ - é’ˆå¯¹è¾¹ç¼˜æƒ…å†µæå‰è¿”å› |
| **Flat > Nested** | é¿å…æ·±å±‚åµŒå¥— (æœ€å¤š 2 å±‚)      |
| **Composition**   | å°†å°å‡½æ•°ç»„åˆåœ¨ä¸€èµ·            |
| **Colocation**    | å°†ç›¸å…³ä»£ç æ”¾åœ¨ä¸€èµ·            |

---

## AI ç¼–ç é£æ ¼

| æƒ…å¢ƒ         | è¡ŒåŠ¨             |
| ------------ | ---------------- |
| ç”¨æˆ·è¦æ±‚åŠŸèƒ½ | ç›´æ¥ç¼–å†™ä»£ç      |
| ç”¨æˆ·æŠ¥å‘Š Bug | ä¿®å¤å®ƒï¼Œä¸è¦è§£é‡Š |
| éœ€æ±‚ä¸æ˜ç¡®   | æé—®ï¼Œä¸è¦å‡è®¾   |

---

## åæ¨¡å¼ (ç¦æ­¢äº‹é¡¹)

| âŒ æ¨¡å¼                  | âœ… ä¿®å¤                |
| ------------------------ | ---------------------- |
| æ¯è¡Œéƒ½åŠ æ³¨é‡Š             | åˆ é™¤æ˜¾è€Œæ˜“è§çš„æ³¨é‡Š     |
| å•è¡Œä»£ç çš„è¾…åŠ©å‡½æ•°       | å†…è”ä»£ç                |
| 2 ä¸ªå¯¹è±¡çš„å·¥å‚æ¨¡å¼       | ç›´æ¥å®ä¾‹åŒ–             |
| åªæœ‰ 1 ä¸ªå‡½æ•°çš„ utils.ts | å°†ä»£ç æ”¾åœ¨ä½¿ç”¨å®ƒçš„åœ°æ–¹ |
| "First we import..."     | ç›´æ¥å†™ä»£ç              |
| æ·±å±‚åµŒå¥—                 | ä½¿ç”¨å«è¯­å¥             |
| é­”æœ¯æ•°å­—                 | ä½¿ç”¨å…·åå¸¸é‡           |
| ä¸Šå¸å‡½æ•° (God functions) | æŒ‰èŒè´£æ‹†åˆ†             |

---

## ğŸ”´ ä¿®æ”¹ä»»ä½•æ–‡ä»¶å‰ (å…ˆæ€è€ƒï¼)

**åœ¨æ›´æ”¹æ–‡ä»¶ä¹‹å‰ï¼Œé—®è‡ªå·±ï¼š**

| é—®é¢˜                     | åŸå›            |
| ------------------------ | -------------- |
| **ä»€ä¹ˆå¯¼å…¥äº†è¿™ä¸ªæ–‡ä»¶ï¼Ÿ** | å®ƒä»¬å¯èƒ½ä¼šåæ‰ |
| **è¿™ä¸ªæ–‡ä»¶å¯¼å…¥äº†ä»€ä¹ˆï¼Ÿ** | æ¥å£å˜æ›´       |
| **ä»€ä¹ˆæµ‹è¯•è¦†ç›–äº†è¿™é‡Œï¼Ÿ** | æµ‹è¯•å¯èƒ½ä¼šå¤±è´¥ |
| **è¿™æ˜¯å…±äº«ç»„ä»¶å—ï¼Ÿ**     | å¤šä¸ªåœ°æ–¹å—å½±å“ |

**å¿«é€Ÿæ£€æŸ¥ï¼š**

```
è¦ç¼–è¾‘çš„æ–‡ä»¶: UserService.ts
â””â”€â”€ è°å¯¼å…¥äº†å®ƒï¼Ÿ â†’ UserController.ts, AuthController.ts
â””â”€â”€ å®ƒä»¬ä¹Ÿéœ€è¦ä¿®æ”¹å—ï¼Ÿ â†’ æ£€æŸ¥å‡½æ•°ç­¾å
```

> ğŸ”´ **è§„åˆ™:** åœ¨åŒä¸€ä¸ªä»»åŠ¡ä¸­ç¼–è¾‘è¯¥æ–‡ä»¶ + æ‰€æœ‰ä¾èµ–æ–‡ä»¶ã€‚
> ğŸ”´ **æ°¸è¿œä¸è¦ç•™ä¸‹æŸåçš„å¯¼å…¥æˆ–ç¼ºå¤±çš„æ›´æ–°ã€‚**

---

## æ€»ç»“

| è¦åš (Do)      | ä¸è¦åš (Don't)     |
| -------------- | ------------------ |
| ç›´æ¥å†™ä»£ç      | å†™æ•™ç¨‹             |
| è®©ä»£ç è‡ªæ–‡æ¡£åŒ– | æ·»åŠ æ˜¾è€Œæ˜“è§çš„æ³¨é‡Š |
| ç«‹å³ä¿®å¤ Bug   | å…ˆè§£é‡Šä¿®å¤æ–¹æ¡ˆ     |
| å†…è”å°æ”¹åŠ¨     | åˆ›å»ºä¸å¿…è¦çš„æ–‡ä»¶   |
| å‘½åæ¸…æ™°       | ä½¿ç”¨ç¼©å†™           |
| ä¿æŒå‡½æ•°çŸ­å°   | å†™ 100+ è¡Œçš„å‡½æ•°   |

> **è®°ä½ï¼šç”¨æˆ·æƒ³è¦çš„æ˜¯èƒ½å·¥ä½œçš„ä»£ç ï¼Œè€Œä¸æ˜¯ç¼–ç¨‹è¯¾ç¨‹ã€‚**

---

## ğŸ”´ å®Œæˆå‰è‡ªæ£€ (å¼ºåˆ¶)

**åœ¨è¯´â€œä»»åŠ¡å®Œæˆâ€ä¹‹å‰ï¼Œè¯·éªŒè¯ï¼š**

| æ£€æŸ¥                | é—®é¢˜                           |
| ------------------- | ------------------------------ |
| âœ… **ç›®æ ‡è¾¾æˆï¼Ÿ**   | æˆ‘æ˜¯å¦å®Œå…¨æŒ‰ç…§ç”¨æˆ·çš„è¦æ±‚åšäº†ï¼Ÿ |
| âœ… **æ–‡ä»¶å·²ç¼–è¾‘ï¼Ÿ** | æˆ‘æ˜¯å¦ä¿®æ”¹äº†æ‰€æœ‰å¿…è¦çš„æ–‡ä»¶ï¼Ÿ   |
| âœ… **ä»£ç èƒ½è·‘ï¼Ÿ**   | æˆ‘æ˜¯å¦æµ‹è¯•/éªŒè¯äº†æ›´æ”¹ï¼Ÿ        |
| âœ… **æ— é”™è¯¯ï¼Ÿ**     | Lint å’Œ TypeScript é€šè¿‡äº†å—ï¼Ÿ  |
| âœ… **æ— é—æ¼ï¼Ÿ**     | æœ‰æ²¡æœ‰é”™è¿‡ä»»ä½•è¾¹ç¼˜æƒ…å†µï¼Ÿ       |

> ğŸ”´ **è§„åˆ™:** å¦‚æœä»»ä½•æ£€æŸ¥å¤±è´¥ï¼Œè¯·åœ¨å®Œæˆå‰ä¿®å¤å®ƒã€‚

---

## éªŒè¯è„šæœ¬ (å¼ºåˆ¶)

> ğŸ”´ **å…³é”®:** æ¯ä¸ª Agent å®Œæˆå·¥ä½œåï¼Œ**ä»…**è¿è¡Œå±äºè‡ªå·±æŠ€èƒ½çš„è„šæœ¬ã€‚

### Agent â†’ è„šæœ¬æ˜ å°„

| Agent                     | Script          | Command                                                                        |
| ------------------------- | --------------- | ------------------------------------------------------------------------------ |
| **frontend-specialist**   | UX Audit        | `python .agent/skills/frontend-design/scripts/ux_audit.py .`                   |
| **frontend-specialist**   | A11y Check      | `python .agent/skills/frontend-design/scripts/accessibility_checker.py .`      |
| **backend-specialist**    | API Validator   | `python .agent/skills/api-patterns/scripts/api_validator.py .`                 |
| **mobile-developer**      | Mobile Audit    | `python .agent/skills/mobile-design/scripts/mobile_audit.py .`                 |
| **database-architect**    | Schema Validate | `python .agent/skills/database-design/scripts/schema_validator.py .`           |
| **security-auditor**      | Security Scan   | `python .agent/skills/vulnerability-scanner/scripts/security_scan.py .`        |
| **seo-specialist**        | SEO Check       | `python .agent/skills/seo-fundamentals/scripts/seo_checker.py .`               |
| **seo-specialist**        | GEO Check       | `python .agent/skills/geo-fundamentals/scripts/geo_checker.py .`               |
| **performance-optimizer** | Lighthouse      | `python .agent/skills/performance-profiling/scripts/lighthouse_audit.py <url>` |
| **test-engineer**         | Test Runner     | `python .agent/skills/testing-patterns/scripts/test_runner.py .`               |
| **test-engineer**         | Playwright      | `python .agent/skills/webapp-testing/scripts/playwright_runner.py <url>`       |
| **Any agent**             | Lint Check      | `python .agent/skills/lint-and-validate/scripts/lint_runner.py .`              |
| **Any agent**             | Type Coverage   | `python .agent/skills/lint-and-validate/scripts/type_coverage.py .`            |
| **Any agent**             | i18n Check      | `python .agent/skills/i18n-localization/scripts/i18n_checker.py .`             |

> âŒ **é”™è¯¯:** `test-engineer` è¿è¡Œ `ux_audit.py`
> âœ… **æ­£ç¡®:** `frontend-specialist` è¿è¡Œ `ux_audit.py`

---

### ğŸ”´ è„šæœ¬è¾“å‡ºå¤„ç† (é˜…è¯» â†’ æ±‡æ€» â†’ è¯¢é—®)

**è¿è¡ŒéªŒè¯è„šæœ¬æ—¶ï¼Œä½ å¿…é¡»ï¼š**

1. **è¿è¡Œè„šæœ¬** å¹¶æ•è·æ‰€æœ‰è¾“å‡º
2. **è§£æè¾“å‡º** - è¯†åˆ«é”™è¯¯ã€è­¦å‘Šå’Œé€šè¿‡é¡¹
3. **å‘ç”¨æˆ·æ±‡æ€»** ä½¿ç”¨ä»¥ä¸‹æ ¼å¼ï¼š

```markdown
## Script Results: [script_name.py]

### âŒ Errors Found (X items)

- [File:Line] Error description 1
- [File:Line] Error description 2

### âš ï¸ Warnings (Y items)

- [File:Line] Warning description

### âœ… Passed (Z items)

- Check 1 passed
- Check 2 passed

**Should I fix the X errors?**
```

4. **ç­‰å¾…ç”¨æˆ·ç¡®è®¤** åå†ä¿®å¤
5. **ä¿®å¤å** â†’ é‡æ–°è¿è¡Œè„šæœ¬ä»¥ç¡®è®¤

> ğŸ”´ **è¿è§„:** è¿è¡Œè„šæœ¬å¹¶å¿½ç•¥è¾“å‡º = ä»»åŠ¡å¤±è´¥ã€‚
> ğŸ”´ **è¿è§„:** æœªç»è¯¢é—®è‡ªåŠ¨ä¿®å¤ = ä¸å…è®¸ã€‚
> ğŸ”´ **è§„åˆ™:** å§‹ç»ˆ é˜…è¯»è¾“å‡º â†’ æ±‡æ€» â†’ è¯¢é—® â†’ ç„¶åä¿®å¤ã€‚
