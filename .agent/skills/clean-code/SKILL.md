---
name: clean-code
description: åŠ¡å®çš„ç¼–ç è§„èŒƒ - ç®€æ´ã€ç›´æ¥ã€æ— è¿‡åº¦è®¾è®¡ã€æ— å†—ä½™æ³¨é‡Š
allowed-tools: Read, Write, Edit
version: 2.0
priority: CRITICAL
---

# ç¼–å†™æ¸…æ´ä»£ç  - åŠ¡å® AI ç¼–ç è§„èŒƒ (Clean Code)

> **æ ¸å¿ƒæŠ€èƒ½** - ä¿æŒ **ç®€æ´ã€ç›´æ¥ã€ä¸“æ³¨äºè§£å†³æ–¹æ¡ˆ**ã€‚

---

## æ ¸å¿ƒåŸåˆ™ (Core Principles)

| åŸåˆ™           | è§„åˆ™                                        |
| -------------- | ------------------------------------------- |
| **SRP**        | å•ä¸€èŒè´£åŸåˆ™ - æ¯ä¸ªå‡½æ•°/ç±»åªåšä¸€ä»¶äº‹        |
| **DRY**        | ä¸è¦é‡å¤è‡ªå·± - æå–é‡å¤å†…å®¹ï¼Œè¿›è¡Œå¤ç”¨       |
| **KISS**       | ä¿æŒç®€å• - é‡‡ç”¨èƒ½è¾¾æˆç›®æ ‡çš„æœ€ç®€æ–¹æ¡ˆ         |
| **YAGNI**      | ä½ ä»¥åæ‰ä¸éœ€è¦å®ƒ - ä¸è¦æ„å»ºç›®å‰ä¸ä½¿ç”¨çš„åŠŸèƒ½ |
| **ç«¥å­å†›å†›è§„** | ç¦»å¼€æ—¶è®©ä»£ç æ¯”ä½ å‘ç°å®ƒæ—¶æ›´æ•´æ´              |

---

## å‘½åè§„èŒƒ (Naming Rules)

| å…ƒç´        | è§„èŒƒ                                             |
| ---------- | ------------------------------------------------ |
| **å˜é‡**   | æ­ç¤ºæ„å›¾: `userCount` è€Œé `n`                   |
| **å‡½æ•°**   | åŠ¨è¯ + åè¯: `getUserById()` è€Œé `user()`       |
| **å¸ƒå°”å€¼** | æé—®å½¢å¼: `isActive`, `hasPermission`, `canEdit` |
| **å¸¸é‡**   | å¤§å†™è›‡å½¢å‘½å: `MAX_RETRY_COUNT`                  |

> **è§„åˆ™:** å¦‚æœä½ éœ€è¦æ³¨é‡Šæ¥è§£é‡Šä¸€ä¸ªåå­—ï¼Œé‚£å°±é‡æ–°å‘½åå®ƒã€‚

---

## å‡½æ•°è§„èŒƒ (Function Rules)

| è§„åˆ™             | æè¿°                           |
| ---------------- | ------------------------------ |
| **çŸ­å°**         | æœ€å¤š 20 è¡Œï¼Œç†æƒ³æƒ…å†µä¸‹ 5-10 è¡Œ |
| **åªåšä¸€ä»¶äº‹**   | åªåšä¸€ä»¶äº‹ï¼Œå¹¶æŠŠå®ƒåšå¥½         |
| **å•ä¸€æŠ½è±¡å±‚çº§** | æ¯ä¸ªå‡½æ•°ä¸­åªåŒ…å«ä¸€ä¸ªæŠ½è±¡å±‚çº§   |
| **å‚æ•°æœ€å°‘åŒ–**   | æœ€å¤š 3 ä¸ªå‚æ•°ï¼Œæ¨è 0-2 ä¸ª     |
| **æ— å‰¯ä½œç”¨**     | ä¸è¦å¯¹è¾“å…¥è¿›è¡Œé¢„æ–™ä¹‹å¤–çš„æ”¹åŠ¨   |

---

## ä»£ç ç»“æ„ (Code Structure)

| æ¨¡å¼                       | åº”ç”¨æ–¹å¼                                 |
| -------------------------- | ---------------------------------------- |
| **å«è¯­å¥ (Guard Clauses)** | å¯¹äºè¾¹ç¼˜æƒ…å†µé‡‡ç”¨æå‰è¿”å› (Early returns) |
| **æ‰å¹³åŒ– > åµŒå¥—**          | é¿å…æ·±åº¦åµŒå¥— (æœ€å¤š 2 å±‚)                 |
| **ç»„åˆ (Composition)**     | å°†å°å‡½æ•°ç»„åˆåœ¨ä¸€èµ·ä½¿ç”¨                   |
| **åŒç½® (Colocation)**      | å°†ç›¸å…³çš„ä»£ç æ”¾åœ¨ç‰©ç†é‚»è¿‘çš„ä½ç½®           |

---

## AI ç¼–ç é£æ ¼ (AI Coding Style)

| åœºæ™¯         | è¡ŒåŠ¨                   |
| ------------ | ---------------------- |
| ç”¨æˆ·è¯·æ±‚åŠŸèƒ½ | ç›´æ¥ç¼–å†™ä»£ç            |
| ç”¨æˆ·æŠ¥å‘Š Bug | ç›´æ¥ä¿®å¤ï¼Œä¸è¦è¿‡å¤šè§£é‡Š |
| éœ€æ±‚ä¸æ˜ç¡®   | æé—®æ¾„æ¸…ï¼Œä¸è¦ç›²ç›®å‡è®¾ |

---

## åæ¨¡å¼ (åº”é¿å… - Anti-Patterns)

| âŒ æ¨¡å¼                   | âœ… ä¿®æ­£æ–¹æ¡ˆ            |
| ------------------------- | ---------------------- |
| æ¯ä¸€è¡Œéƒ½åŠ æ³¨é‡Š            | åˆ é™¤æ˜¾è€Œæ˜“è§çš„æ³¨é‡Š     |
| ä¸ºä¸€è¡Œä»£ç å°è£… Helper     | å°†ä»£ç å†…è” (Inline)    |
| ä¸º 2 ä¸ªå¯¹è±¡å†™å·¥å‚æ¨¡å¼     | ç›´æ¥å®ä¾‹åŒ–             |
| åªæœ‰ä¸€ä¸ªå‡½æ•°çš„ `utils.ts` | å°†ä»£ç æ”¾å…¥ä½¿ç”¨å®ƒçš„ä½ç½® |
| "é¦–å…ˆæˆ‘ä»¬å¯¼å…¥..."         | ç›´æ¥å†™ä»£ç              |
| æ·±åº¦åµŒå¥—å¾ªç¯/åˆ¤æ–­         | ä½¿ç”¨å«è¯­å¥             |
| é­”æ³•æ•°å­—                  | ä½¿ç”¨å…·åå¸¸é‡           |
| å·¨å‹å‡½æ•° (God functions)  | æŒ‰èŒè´£è¿›è¡Œæ‹†åˆ†         |

---

## ğŸ”´ åœ¨ç¼–è¾‘ä»»ä½•æ–‡ä»¶å‰ (å…ˆæ€è€ƒï¼)

**åœ¨æ”¹åŠ¨æ–‡ä»¶å‰ï¼Œå…ˆé—®è‡ªå·±ï¼š**

| é—®é¢˜                       | ä¸ºä»€ä¹ˆ             |
| -------------------------- | ------------------ |
| **è°å¯¼å…¥äº†è¿™ä¸ªæ–‡ä»¶ï¼Ÿ**     | å®ƒä»¬å¯èƒ½ä¼šå› æ­¤æŸå |
| **è¿™ä¸ªæ–‡ä»¶å¯¼å…¥äº†ä»€ä¹ˆï¼Ÿ**   | æ¶‰åŠæ¥å£å˜æ›´       |
| **æœ‰å“ªäº›æµ‹è¯•è¦†ç›–äº†è¿™é‡Œï¼Ÿ** | æµ‹è¯•å¯èƒ½ä¼šå¤±è´¥     |
| **è¿™æ˜¯ä¸€ä¸ªå…±äº«ç»„ä»¶å—ï¼Ÿ**   | å¯èƒ½å½±å“å¤šä¸ªåœ°æ–¹   |

**å¿«é€Ÿæ£€æŸ¥ç¤ºä¾‹:**

```
å‡†å¤‡ç¼–è¾‘çš„æ–‡ä»¶: UserService.ts
â””â”€â”€ è°å¯¼å…¥äº†å®ƒï¼Ÿ â†’ UserController.ts, AuthController.ts
â””â”€â”€ å®ƒä»¬ä¹Ÿéœ€è¦æ”¹åŠ¨å—ï¼Ÿ â†’ æ£€æŸ¥å‡½æ•°ç­¾åæ˜¯å¦ä¸€è‡´
```

> **ğŸ”´ è§„åˆ™:** åœ¨åŒä¸€ä¸ªä»»åŠ¡ä¸­ç¼–è¾‘è¯¥æ–‡ä»¶åŠå…¶æ‰€æœ‰ç›¸å…³çš„ä¾èµ–æ–‡ä»¶ã€‚
> **ğŸ”´ å†³ä¸å…è®¸ç•™ä¸‹æŸåçš„å¯¼å…¥æˆ–ç¼ºå¤±çš„æ›´æ–°ã€‚**

---

## æ€»ç»“ (Summary)

| åº”è¯¥åš (Do)      | ä¸è¯¥åš (Don't)          |
| ---------------- | ----------------------- |
| ç›´æ¥ç¼–å†™ä»£ç      | å†™æ•™ç¨‹å¼çš„å†—é•¿è¯´æ˜      |
| è®©ä»£ç è‡ªæ–‡æ¡£åŒ–   | æ·»åŠ æ˜¾è€Œæ˜“è§çš„æ³¨é‡Š      |
| å‘ç°é—®é¢˜ç«‹å³ä¿®å¤ | ä¿®å¤å‰å…ˆé•¿ç¯‡å¤§è®ºè§£é‡Š    |
| å†…è”ç»†å°é€»è¾‘     | åˆ›å»ºä¸å¿…è¦çš„é›¶æ•£æ–‡ä»¶    |
| å‘½åæ¸…æ™°ç›´è§‚     | ä½¿ç”¨ç®€å†™æˆ–ç¼©å†™          |
| ä¿æŒå‡½æ•°çŸ­å°ç²¾æ‚ | ç¼–å†™è¶…è¿‡ 100 è¡Œçš„é•¿å‡½æ•° |

> **è®°ä½: ç”¨æˆ·æƒ³è¦çš„æ˜¯èƒ½è¿è¡Œçš„ä»£ç ï¼Œè€Œä¸æ˜¯ä¸€å ‚ç¼–ç¨‹è¯¾ã€‚**

---

## ğŸ”´ å®Œæˆå‰çš„è‡ªæ£€ (å¼ºåˆ¶è¦æ±‚)

**åœ¨è¯´ "ä»»åŠ¡å®Œæˆ" ä¹‹å‰ï¼Œè¯·æ ¸å®ï¼š**

| æ£€æŸ¥é¡¹                  | æé—®                          |
| ----------------------- | ----------------------------- |
| âœ… **ç›®æ ‡è¾¾æˆäº†å—ï¼Ÿ**   | æˆ‘æ˜¯å¦ç²¾å‡†å®Œæˆäº†ç”¨æˆ·çš„è¦æ±‚ï¼Ÿ  |
| âœ… **æ–‡ä»¶ç¼–è¾‘å…¨äº†å—ï¼Ÿ** | æˆ‘æ˜¯å¦ä¿®æ”¹äº†æ‰€æœ‰å¿…è¦çš„æ–‡ä»¶ï¼Ÿ  |
| âœ… **ä»£ç èƒ½è¿è¡Œå—ï¼Ÿ**   | æˆ‘æ˜¯å¦æµ‹è¯•/éªŒè¯äº†å˜æ›´ï¼Ÿ       |
| âœ… **æ²¡æœ‰é”™è¯¯å—ï¼Ÿ**     | Lint å’Œ TypeScript æ˜¯å¦é€šè¿‡ï¼Ÿ |
| âœ… **æ²¡æœ‰é—æ¼å—ï¼Ÿ**     | æ‰€æœ‰çš„è¾¹ç¼˜æƒ…å†µéƒ½è€ƒè™‘åˆ°äº†å—ï¼Ÿ  |

> **ğŸ”´ è§„åˆ™:** å¦‚æœä»»ä½•æ£€æŸ¥é¡¹æœªé€šè¿‡ï¼Œè¯·åœ¨è¯´å®Œæˆå‰ä¿®å¤å®ƒã€‚

---

## éªŒè¯è„šæœ¬ (Verification Scripts - å¼ºåˆ¶è¦æ±‚)

> **ğŸ”´ å…³é”®:** æ¯ä¸ª Agent åœ¨å®Œæˆå·¥ä½œåï¼Œä»…è¿è¡Œä¸å…¶æŠ€èƒ½ç›¸å…³çš„è„šæœ¬ã€‚

### Agent â†’ è„šæœ¬æ˜ å°„å…³ç³»

| Agent                     | è„šæœ¬åˆ†ç±»        | æ‰§è¡Œå‘½ä»¤                                                                       |
| ------------------------- | --------------- | ------------------------------------------------------------------------------ |
| **frontend-specialist**   | UX å®¡è®¡         | `python .agent/skills/frontend-design/scripts/ux_audit.py .`                   |
| **frontend-specialist**   | æ— éšœç¢æ£€æŸ¥      | `python .agent/skills/frontend-design/scripts/accessibility_checker.py .`      |
| **backend-specialist**    | API éªŒè¯å™¨      | `python .agent/skills/api-patterns/scripts/api_validator.py .`                 |
| **mobile-developer**      | ç§»åŠ¨ç«¯å®¡è®¡      | `python .agent/skills/mobile-design/scripts/mobile_audit.py .`                 |
| **database-architect**    | Schema éªŒè¯     | `python .agent/skills/database-design/scripts/schema_validator.py .`           |
| **security-auditor**      | å®‰å…¨æ‰«æ        | `python .agent/skills/vulnerability-scanner/scripts/security_scan.py .`        |
| **seo-specialist**        | SEO æ£€æŸ¥        | `python .agent/skills/seo-fundamentals/scripts/seo_checker.py .`               |
| **seo-specialist**        | GEO æ£€æŸ¥        | `python .agent/skills/geo-fundamentals/scripts/geo_checker.py .`               |
| **performance-optimizer** | Lighthouse å®¡è®¡ | `python .agent/skills/performance-profiling/scripts/lighthouse_audit.py <url>` |
| **test-engineer**         | æµ‹è¯•è¿è¡Œå™¨      | `python .agent/skills/testing-patterns/scripts/test_runner.py .`               |
| **test-engineer**         | Playwright E2E  | `python .agent/skills/webapp-testing/scripts/playwright_runner.py <url>`       |
| **ä»»æ„ Agent**            | Lint æ£€æŸ¥       | `python .agent/skills/lint-and-validate/scripts/lint_runner.py .`              |
| **ä»»æ„ Agent**            | ç±»å‹è¦†ç›–ç‡      | `python .agent/skills/lint-and-validate/scripts/type_coverage.py .`            |
| **ä»»æ„ Agent**            | i18n æ£€æŸ¥       | `python .agent/skills/i18n-localization/scripts/i18n_checker.py .`             |

> âŒ **é”™è¯¯åšæ³•:** `test-engineer` è¿è¡Œ `ux_audit.py`
> âœ… **æ­£ç¡®åšæ³•:** `frontend-specialist` è¿è¡Œ `ux_audit.py`

---

### ğŸ”´ è„šæœ¬è¾“å‡ºå¤„ç†åŸåˆ™ (é˜…è¯» â†’ æ±‡æ€» â†’ è¯¢é—®)

**è¿è¡ŒéªŒè¯è„šæœ¬æ—¶ï¼Œä½ å¿…é¡»ï¼š**

1. **è¿è¡Œè„šæœ¬**å¹¶æ•è·æ‰€æœ‰è¾“å‡ºã€‚
2. **è§£æè¾“å‡º** - è¯†åˆ«é”™è¯¯ã€è­¦å‘Šå’Œé€šè¿‡é¡¹ã€‚
3. **å‘ç”¨æˆ·æ±‡æ€»** ä½¿ç”¨ä»¥ä¸‹æ ¼å¼ï¼š

```markdown
## è„šæœ¬æ‰§è¡Œç»“æœ: [è„šæœ¬åç§°.py]

### âŒ å‘ç°é”™è¯¯ (X é¡¹)

- [æ–‡ä»¶:è¡Œå·] é”™è¯¯æè¿° 1
- [æ–‡ä»¶:è¡Œå·] é”™è¯¯æè¿° 2

### âš ï¸ è­¦å‘Š (Y é¡¹)

- [æ–‡ä»¶:è¡Œå·] è­¦å‘Šæè¿°

### âœ… é€šè¿‡é¡¹ (Z é¡¹)

- æ£€æŸ¥é¡¹ 1 å·²é€šè¿‡
- æ£€æŸ¥é¡¹ 2 å·²é€šè¿‡

**æ˜¯å¦éœ€è¦æˆ‘ä¿®å¤è¿™ X ä¸ªé”™è¯¯ï¼Ÿ**
```

4. **ç­‰å¾…ç”¨æˆ·ç¡®è®¤** åå†å¼€å§‹ä¿®å¤ã€‚
5. **ä¿®å¤å** â†’ é‡æ–°è¿è¡Œè„šæœ¬ä»¥ç¡®è®¤ã€‚

> **ğŸ”´ è¿è§„:** è¿è¡Œè„šæœ¬å¹¶å¿½ç•¥è¾“å‡º = ä»»åŠ¡å¤±è´¥ã€‚
> **ğŸ”´ è¿è§„:** æœªç»è¯¢é—®è‡ªåŠ¨ä¿®å¤è„šæœ¬æŠ¥é”™ = ä¸å…è®¸ã€‚
> **ğŸ”´ è§„åˆ™:** å§‹ç»ˆ é˜…è¯»è¾“å‡º â†’ æ±‡æ€» â†’ è¯¢é—® â†’ ç„¶åä¿®å¤ã€‚
